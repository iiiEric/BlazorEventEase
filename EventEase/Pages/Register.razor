@page "/register/{eventId:int}"
@using EventEase.Data
@using EventEase.Models
@inject UserSessionService SessionService
@inject NavigationManager NavManager

<h3>Registro de evento</h3>

<EditForm Model="registerModel" OnValidSubmit="HandleValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div>
        <label>Nombre:</label>
        <InputText @bind-Value="registerModel.Name" />
    </div>
    <div>
        <label>Email:</label>
        <InputText @bind-Value="registerModel.Email" />
    </div>
    <button type="submit">Enviar registro</button>
</EditForm>

<p>@statusMessage</p>

<!-- Botón volver atrás -->
<button @onclick="GoBack">⬅️ Volver al detalle</button>

@code {
    [Parameter] public int EventId { get; set; }
    private RegisterModel registerModel = new();
    private string statusMessage = string.Empty;

    private void HandleValidSubmit()
    {
        SessionService.RegisterUser(EventId, registerModel);
        statusMessage = $"✅ Usuario {registerModel.Name} registrado correctamente.";
    }

    private void GoBack()
    {
        NavManager.NavigateTo($"/eventdetails/{EventId}");
    }
}
